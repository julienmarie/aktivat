(function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a){this.options=a,this.onUnload=c(this.onUnload,this),this.ajaxpost=c(this.ajaxpost,this),this.post=c(this.post,this),this.trackClicks=c(this.trackClicks,this),this.trackPageEnd=c(this.trackPageEnd,this),this.trackPageStart=c(this.trackPageStart,this),this.options.trackrClass||(this.options.trackrClass=".trackit"),this.options.serverUrl||(this.options.serverUrl="http://www.trackit.io"),this.options.sessionCookieName||(this.options.sessionCookieName="trackit_session"),this.options.v_visitorCookieName||(this.options.v_visitorCookieName="trackit_v_visitor"),this.options.visitorCookieName||(this.options.visitorCookieName="trackit_visitor"),this.options.loadstartvariable||(this.options.loadstartvariable="trackrloadstart"),this.options.tabIdPrefix||(this.options.tabIdPrefix="trackit_tab_"),this.options.trackTabs||(this.options.trackTabs=!0),this.setConfig(),this.createClassSelector(),this.main(),this.trackPageDuration()}return a.prototype.trackPageStart=function(){return this.privTrackPageDuration(),window[this.options.loadstartvariable]=(new Date).getTime()},a.prototype.trackPageEnd=function(){var a;return a={trackr_event_type:"trackr_pageloaded_event",trackr_page_loadtime:page_loadtime},this.post(a)},a.prototype.signupUser=function(a,b,c){return void 0===typeof c&&(c=(new Date).getTime()),this.createCookie(this.options.visitorCookieName,a,31536e6),b.trackr_event_type="trackr_signupUser_event",b.signupDate=c,this.post(b),void 0},a.prototype.loginUser=function(a){return this.createCookie(this.options.visitorCookieName,a,31536e6),data.trackr_event_type="trackr_loginUser_event",this.post(data),void 0},a.prototype.loginAndImportUser=function(a,b,c){return this.createCookie(this.options.visitorCookieName,a,31536e6),b.trackr_event_type="trackr_loginUser_event",b.signupDate=c,this.post(b),void 0},a.prototype.updateUser=function(a){return a.trackr_event_type="trackr_updateUser_event",a.signupDate=signupDate,this.post(a),void 0},a.prototype.logoutUser=function(){return this.eraseCookie(this.options.visitorCookieName),data.trackr_event_type="trackr_logoutUser_event",this.post(data),void 0},a.prototype.main=function(){var a=this;return"interactive"===document.readyState?this.startupItems():document.onreadystatechange=function(){return"interactive"===document.readyState?a.startupItems():void 0}},a.prototype.startupItems=function(){return this.trackPageLoadComplete(),this.trackClicks()},a.prototype.trackPageLoadComplete=function(){var a,b;return b=window.performance?window.performance.timing.domInteractive-window.performance.timing.responseEnd:(new Date).getTime()-window[this.options.loadstartvariable],a={trackr_event_type:"trackr_pageloaded_event",trackr_page_loadtime:b},this.post(a)},a.prototype.trackClicks=function(){var a,c=this;return a=this.select(this.options.trackrClass),b(a,"click",function(a){var b,d;return d=a.target||a.srcElement,d&&d.getAttribute("data-trackr-label")&&d.getAttribute("data-trackr-position")&&d.getAttribute("data-trackr-type")?(b={trackr_event_type:"trackr_element_event",trackr_element_event:"click",trackr_element_label:d.getAttribute("data-trackr-label"),trackr_element_position:d.getAttribute("data-trackr-position"),trackr_element_type:d.getAttribute("data-trackr-type")},c.post(b)):void 0}),b(a,"mouseover",function(a){var b,d;return d=a.target||a.srcElement,d&&d.getAttribute("data-trackr-label")&&d.getAttribute("data-trackr-position")&&d.getAttribute("data-trackr-type")?(b={trackr_event_type:"trackr_element_event",trackr_element_event:"mouseover",trackr_element_label:d.getAttribute("data-trackr-label"),trackr_element_position:d.getAttribute("data-trackr-position"),trackr_element_type:d.getAttribute("data-trackr-type")},c.post(b)):void 0}),b(a,"focus",function(a){var b,d;return d=a.target||a.srcElement,d&&d.getAttribute("data-trackr-label")&&d.getAttribute("data-trackr-position")&&d.getAttribute("data-trackr-type")?(b={trackr_event_type:"trackr_element_event",trackr_element_event:"focus",trackr_element_label:d.getAttribute("data-trackr-label"),trackr_element_position:d.getAttribute("data-trackr-position"),trackr_element_type:d.getAttribute("data-trackr-type")},c.post(b)):void 0}),b(a,"blur",function(a){var b,d;return d=a.target||a.srcElement,d&&d.getAttribute("data-trackr-label")&&d.getAttribute("data-trackr-position")&&d.getAttribute("data-trackr-type")?(b={trackr_event_type:"trackr_element_event",trackr_element_event:"blur",trackr_element_label:d.getAttribute("data-trackr-label"),trackr_element_position:d.getAttribute("data-trackr-position"),trackr_element_type:d.getAttribute("data-trackr-type"),trackr_element_value:d.value},c.post(b)):void 0}),b(a,"keyup",function(a){var b,d;return d=a.target||a.srcElement,d&&d.getAttribute("data-trackr-label")&&d.getAttribute("data-trackr-position")&&d.getAttribute("data-trackr-type")?(b={trackr_event_type:"trackr_element_event",trackr_element_event:"keyup",trackr_element_label:d.getAttribute("data-trackr-label"),trackr_element_position:d.getAttribute("data-trackr-position"),trackr_element_type:d.getAttribute("data-trackr-type"),trackr_element_char:a.keyCode},c.post(b)):void 0})},a.prototype.trackPageDuration=function(){var a=this;return this.onUnload(function(){return a.privTrackPageDuration()})},a.prototype.privTrackPageDuration=function(){var a;return a={trackr_event_type:"trackr_visitDuration_event",trackr_visit_time:(new Date).getTime()-window[this.options.loadstartvariable]},this.ajaxpost(a),void 0},a.prototype.setConfig=function(){return this.config={config:{account:this.options.account,screen:{width:screen.width,height:screen.height},cookies:{session:this.getCookie(this.options.sessionCookieName,12e5),v_visitor:this.getCookie(this.options.v_visitorCookieName,31536e6),visitor:this.readCookie(this.options.visitorCookieName)?this.readCookie(this.options.visitorCookieName):void 0},tab:this.options.trackTabs===!0?this.getTab():void 0}}},a.prototype.generateUuuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b,c;return b=0|16*Math.random(),c="x"===a?b:8|3&b,c.toString(16)})},a.prototype.post=function(a){var b,c;return c=new Image,b=this.generateUuuid(),c.src=""+this.options.serverUrl+"/track/it?"+this.serialize(a)+"&"+this.serialize(this.config)+"&"+this.serialize(this.getUrl())+"&event_id="+b},a.prototype.ajaxpost=function(a){var b,c,d,e;return c=this.generateUuuid(),b=!1,d=""+this.options.serverUrl+"/track/it?"+this.serialize(a)+"&"+this.serialize(this.config)+"&"+this.serialize(this.getUrl())+"&event_id="+c,e=new XMLHttpRequest,e.open("GET",d,b),e.send(),e},a.prototype.getUrl=function(){return{hostname:window.location.hostname,path:window.location.pathname,hash:window.location.hash,args:this.getArgs()}},a.prototype.getArgs=function(){var a,b,c,d,e,f;for(e={},d=window.location.search.substring(1),f=d.split("&"),b=0;b<f.length;)c=f[b].split("="),"undefined"==typeof e[c[0]]?e[c[0]]=c[1]:"string"==typeof e[c[0]]?(a=[e[c[0]],c[1]],e[c[0]]=a):e[c[0]].push(c[1]),b++;return e},a.prototype.serialize=function(a,b){var c,d,e,f;e=[];for(d in a)c=b?b+"_"+d:d,f=a[d],e.push("object"==typeof f?this.serialize(f,c):encodeURIComponent(c)+"="+encodeURIComponent(f));return e.join("&")},a.prototype.getCookie=function(a,b){var c;return null!==this.readCookie(a)?(c=this.readCookie(a),this.createCookie(a,c,b),c):(c=this.generateUuuid(),this.createCookie(a,c,b),c)},a.prototype.createCookie=function(a,b,c){var d,e;return d=new Date,d.setTime(d.getTime()+c),e="; expires="+d.toGMTString(),document.cookie=a+"="+b+e+"; path=/"},a.prototype.readCookie=function(a){var b,c,d,e;for(e=a+"=",c=document.cookie.split(";"),d=0;d<c.length;){for(b=c[d];" "===b.charAt(0);)b=b.substring(1,b.length);if(0===b.indexOf(e))return b.substring(e.length,b.length);d++}return null},a.prototype.eraseCookie=function(a){return createCookie(a,"",-1)},a.prototype.onUnload=function(a){return window.onunload=a},a.prototype.createClassSelector=function(){return document.getElementsByClassName?void 0:document.getElementsByClassName=function(a,b){var c,d,e,f,g;if(c=void 0,f=[],d=0,e=void 0,g=new RegExp("(?:\\s|^)"+a+"(?:\\s|$)"),c=document.getElementsByTagName(b||"*"),!c[0])return!1;for(e=c.length;e>d;)c[d].className.match(g)&&f.push(c[d]),d++;return f}},a.prototype.select=function(a,b){var c;if(c=a.charAt(0),document.querySelectorAll)return document.querySelectorAll(a);switch(c){case"#":return document.getElementById(a.slice(1));case".":return document.getElementsByClassName(a.slice(1),b);default:return document.getElementsByTagName(a)}},a.prototype.cancelEvent=function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1},a.prototype.getTab=function(){return this.options.trackTabs===!0?window.name.substring(0,this.options.tabIdPrefix.length)===this.options.tabIdPrefix?window.name.replace(this.options.tabIdPrefix,""):(window.name=""+this.options.tabIdPrefix+this.generateUuuid(),window.name.replace(this.options.tabIdPrefix,"")):void 0},a}(),b=function(){var a;return a=function(a,c,d){var e,f,g;for(e=0,f=a.length,g=[];f>e;)b(a[e],c,d),g.push(e++);return g},document.addEventListener?function(b,c,d){return b&&b.nodeName||b===window?b.addEventListener(c,d,!1):b&&b.length?a(b,c,d):void 0}:function(b,c,d){return b&&b.nodeName||b===window?b.attachEvent("on"+c,function(){return d.call(b,window.event)}):b&&b.length?a(b,c,d):void 0}}(),window.Trackr=a}).call(this);